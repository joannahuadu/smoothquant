nohup: ignoring input
Running with alpha=0.0

Downloading readme:   0%|          | 0.00/10.5k [00:00<?, ?B/s]
Downloading readme: 100%|██████████| 10.5k/10.5k [00:01<00:00, 7.55kB/s]
Downloading readme: 100%|██████████| 10.5k/10.5k [00:01<00:00, 7.55kB/s]

Downloading data:   0%|          | 0.00/733k [00:00<?, ?B/s]
Downloading data: 100%|██████████| 733k/733k [00:01<00:00, 536kB/s]
Downloading data: 100%|██████████| 733k/733k [00:01<00:00, 536kB/s]

Downloading data:   0%|          | 0.00/6.36M [00:00<?, ?B/s]
Downloading data: 100%|██████████| 6.36M/6.36M [00:00<00:00, 6.49MB/s]
Downloading data: 100%|██████████| 6.36M/6.36M [00:00<00:00, 6.47MB/s]

Downloading data:   0%|          | 0.00/657k [00:00<?, ?B/s]
Downloading data: 100%|██████████| 657k/657k [00:00<00:00, 901kB/s]
Downloading data: 100%|██████████| 657k/657k [00:00<00:00, 900kB/s]

Generating test split:   0%|          | 0/4358 [00:00<?, ? examples/s]
Generating test split: 100%|██████████| 4358/4358 [00:00<00:00, 404236.74 examples/s]

Generating train split:   0%|          | 0/36718 [00:00<?, ? examples/s]
Generating train split: 100%|██████████| 36718/36718 [00:00<00:00, 1015578.95 examples/s]

Generating validation split:   0%|          | 0/3760 [00:00<?, ? examples/s]
Generating validation split: 100%|██████████| 3760/3760 [00:00<00:00, 910962.51 examples/s]
Token indices sequence length is longer than the specified maximum sequence length for this model (289077 > 131072). Running this sequence through the model will result in indexing errors

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.57s/it]
Loading checkpoint shards:  50%|█████     | 2/4 [00:06<00:06,  3.36s/it]
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:10<00:03,  3.36s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:10<00:00,  2.36s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:10<00:00,  2.75s/it]
/gemini/code/NMSparsity/smoothquant/smoothquant/ppl_eval.py:85: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  act_s
Evaluating...:   0%|          | 0/141 [00:00<?, ?it/s]
Evaluating...:   1%|          | 1/141 [00:00<00:58,  2.40it/s]
Evaluating...:   2%|▏         | 3/141 [00:00<00:26,  5.26it/s]
Evaluating...:   3%|▎         | 4/141 [00:00<00:23,  5.92it/s]
Evaluating...:   4%|▎         | 5/141 [00:00<00:21,  6.39it/s]
Evaluating...:   4%|▍         | 6/141 [00:01<00:20,  6.74it/s]
Evaluating...:   5%|▍         | 7/141 [00:01<00:19,  6.99it/s]
Evaluating...:   6%|▌         | 8/141 [00:01<00:18,  7.16it/s]
Evaluating...:   6%|▋         | 9/141 [00:01<00:18,  7.29it/s]
Evaluating...:   7%|▋         | 10/141 [00:01<00:17,  7.42it/s]
Evaluating...:   8%|▊         | 11/141 [00:01<00:17,  7.52it/s]
Evaluating...:   9%|▊         | 12/141 [00:01<00:17,  7.55it/s]
Evaluating...:   9%|▉         | 13/141 [00:01<00:16,  7.59it/s]
Evaluating...:  10%|▉         | 14/141 [00:02<00:16,  7.60it/s]
Evaluating...:  11%|█         | 15/141 [00:02<00:16,  7.62it/s]
Evaluating...:  11%|█▏        | 16/141 [00:02<00:16,  7.62it/s]
Evaluating...:  12%|█▏        | 17/141 [00:02<00:16,  7.64it/s]
Evaluating...:  13%|█▎        | 18/141 [00:02<00:16,  7.63it/s]
Evaluating...:  13%|█▎        | 19/141 [00:02<00:15,  7.65it/s]
Evaluating...:  14%|█▍        | 20/141 [00:02<00:15,  7.64it/s]
Evaluating...:  15%|█▍        | 21/141 [00:02<00:15,  7.63it/s]
Evaluating...:  16%|█▌        | 22/141 [00:03<00:15,  7.62it/s]
Evaluating...:  16%|█▋        | 23/141 [00:03<00:15,  7.62it/s]
Evaluating...:  17%|█▋        | 24/141 [00:03<00:15,  7.64it/s]
Evaluating...:  18%|█▊        | 25/141 [00:03<00:15,  7.64it/s]
Evaluating...:  18%|█▊        | 26/141 [00:03<00:15,  7.63it/s]
Evaluating...:  19%|█▉        | 27/141 [00:03<00:14,  7.63it/s]
Evaluating...:  20%|█▉        | 28/141 [00:03<00:14,  7.64it/s]
Evaluating...:  21%|██        | 29/141 [00:04<00:14,  7.64it/s]
Evaluating...:  21%|██▏       | 30/141 [00:04<00:14,  7.63it/s]
Evaluating...:  22%|██▏       | 31/141 [00:04<00:14,  7.67it/s]
Evaluating...:  23%|██▎       | 32/141 [00:04<00:14,  7.66it/s]
Evaluating...:  23%|██▎       | 33/141 [00:04<00:14,  7.65it/s]
Evaluating...:  24%|██▍       | 34/141 [00:04<00:13,  7.65it/s]
Evaluating...:  25%|██▍       | 35/141 [00:04<00:13,  7.64it/s]
Evaluating...:  26%|██▌       | 36/141 [00:04<00:13,  7.63it/s]
Evaluating...:  26%|██▌       | 37/141 [00:05<00:13,  7.63it/s]
Evaluating...:  27%|██▋       | 38/141 [00:05<00:13,  7.65it/s]
Evaluating...:  28%|██▊       | 39/141 [00:05<00:13,  7.65it/s]
Evaluating...:  28%|██▊       | 40/141 [00:05<00:13,  7.63it/s]
Evaluating...:  29%|██▉       | 41/141 [00:05<00:13,  7.62it/s]
Evaluating...:  30%|██▉       | 42/141 [00:05<00:13,  7.61it/s]
Evaluating...:  30%|███       | 43/141 [00:05<00:12,  7.62it/s]
Evaluating...:  31%|███       | 44/141 [00:06<00:12,  7.66it/s]
Evaluating...:  32%|███▏      | 45/141 [00:06<00:12,  7.65it/s]
Evaluating...:  33%|███▎      | 46/141 [00:06<00:12,  7.64it/s]
Evaluating...:  33%|███▎      | 47/141 [00:06<00:12,  7.63it/s]
Evaluating...:  34%|███▍      | 48/141 [00:06<00:12,  7.64it/s]
Evaluating...:  35%|███▍      | 49/141 [00:06<00:12,  7.63it/s]
Evaluating...:  35%|███▌      | 50/141 [00:06<00:11,  7.63it/s]
Evaluating...:  36%|███▌      | 51/141 [00:06<00:11,  7.66it/s]
Evaluating...:  37%|███▋      | 52/141 [00:07<00:11,  7.66it/s]
Evaluating...:  38%|███▊      | 53/141 [00:07<00:11,  7.66it/s]
Evaluating...:  38%|███▊      | 54/141 [00:07<00:11,  7.64it/s]
Evaluating...:  39%|███▉      | 55/141 [00:07<00:11,  7.63it/s]
Evaluating...:  40%|███▉      | 56/141 [00:07<00:11,  7.62it/s]
Evaluating...:  40%|████      | 57/141 [00:07<00:11,  7.64it/s]
Evaluating...:  41%|████      | 58/141 [00:07<00:10,  7.66it/s]
Evaluating...:  42%|████▏     | 59/141 [00:07<00:10,  7.65it/s]
Evaluating...:  43%|████▎     | 60/141 [00:08<00:10,  7.63it/s]
Evaluating...:  43%|████▎     | 61/141 [00:08<00:10,  7.64it/s]
Evaluating...:  44%|████▍     | 62/141 [00:08<00:10,  7.58it/s]
Evaluating...:  45%|████▍     | 63/141 [00:08<00:10,  7.59it/s]
Evaluating...:  45%|████▌     | 64/141 [00:08<00:10,  7.61it/s]
Evaluating...:  46%|████▌     | 65/141 [00:08<00:09,  7.61it/s]
Evaluating...:  47%|████▋     | 66/141 [00:08<00:09,  7.61it/s]
Evaluating...:  48%|████▊     | 67/141 [00:09<00:09,  7.61it/s]
Evaluating...:  48%|████▊     | 68/141 [00:09<00:09,  7.65it/s]
Evaluating...:  49%|████▉     | 69/141 [00:09<00:09,  7.65it/s]
Evaluating...:  50%|████▉     | 70/141 [00:09<00:09,  7.64it/s]
Evaluating...:  50%|█████     | 71/141 [00:09<00:09,  7.63it/s]
Evaluating...:  51%|█████     | 72/141 [00:09<00:09,  7.62it/s]
Evaluating...:  52%|█████▏    | 73/141 [00:09<00:08,  7.62it/s]
Evaluating...:  52%|█████▏    | 74/141 [00:09<00:08,  7.62it/s]
Evaluating...:  53%|█████▎    | 75/141 [00:10<00:08,  7.65it/s]
Evaluating...:  54%|█████▍    | 76/141 [00:10<00:08,  7.63it/s]
Evaluating...:  55%|█████▍    | 77/141 [00:10<00:08,  7.64it/s]
Evaluating...:  55%|█████▌    | 78/141 [00:10<00:08,  7.63it/s]
Evaluating...:  56%|█████▌    | 79/141 [00:10<00:08,  7.63it/s]
Evaluating...:  57%|█████▋    | 80/141 [00:10<00:07,  7.63it/s]
Evaluating...:  57%|█████▋    | 81/141 [00:10<00:07,  7.64it/s]
Evaluating...:  58%|█████▊    | 82/141 [00:10<00:07,  7.63it/s]
Evaluating...:  59%|█████▉    | 83/141 [00:11<00:07,  7.62it/s]
Evaluating...:  60%|█████▉    | 84/141 [00:11<00:07,  7.62it/s]
Evaluating...:  60%|██████    | 85/141 [00:11<00:07,  7.63it/s]
Evaluating...:  61%|██████    | 86/141 [00:11<00:07,  7.62it/s]
Evaluating...:  62%|██████▏   | 87/141 [00:11<00:07,  7.61it/s]
Evaluating...:  62%|██████▏   | 88/141 [00:11<00:06,  7.64it/s]
Evaluating...:  63%|██████▎   | 89/141 [00:11<00:06,  7.64it/s]
Evaluating...:  64%|██████▍   | 90/141 [00:12<00:06,  7.66it/s]
Evaluating...:  65%|██████▍   | 91/141 [00:12<00:06,  7.65it/s]
Evaluating...:  65%|██████▌   | 92/141 [00:12<00:06,  7.64it/s]
Evaluating...:  66%|██████▌   | 93/141 [00:12<00:06,  7.63it/s]
Evaluating...:  67%|██████▋   | 94/141 [00:12<00:06,  7.63it/s]
Evaluating...:  67%|██████▋   | 95/141 [00:12<00:06,  7.66it/s]
Evaluating...:  68%|██████▊   | 96/141 [00:12<00:05,  7.64it/s]
Evaluating...:  69%|██████▉   | 97/141 [00:12<00:05,  7.62it/s]
Evaluating...:  70%|██████▉   | 98/141 [00:13<00:05,  7.61it/s]
Evaluating...:  70%|███████   | 99/141 [00:13<00:05,  7.61it/s]
Evaluating...:  71%|███████   | 100/141 [00:13<00:05,  7.61it/s]
Evaluating...:  72%|███████▏  | 101/141 [00:13<00:05,  7.61it/s]
Evaluating...:  72%|███████▏  | 102/141 [00:13<00:05,  7.65it/s]
Evaluating...:  73%|███████▎  | 103/141 [00:13<00:04,  7.64it/s]
Evaluating...:  74%|███████▍  | 104/141 [00:13<00:04,  7.63it/s]
Evaluating...:  74%|███████▍  | 105/141 [00:13<00:04,  7.62it/s]
Evaluating...:  75%|███████▌  | 106/141 [00:14<00:04,  7.62it/s]
Evaluating...:  76%|███████▌  | 107/141 [00:14<00:04,  7.62it/s]
Evaluating...:  77%|███████▋  | 108/141 [00:14<00:04,  7.64it/s]
Evaluating...:  77%|███████▋  | 109/141 [00:14<00:04,  7.65it/s]
Evaluating...:  78%|███████▊  | 110/141 [00:14<00:04,  7.66it/s]
Evaluating...:  79%|███████▊  | 111/141 [00:14<00:03,  7.65it/s]
Evaluating...:  79%|███████▉  | 112/141 [00:14<00:03,  7.64it/s]
Evaluating...:  80%|████████  | 113/141 [00:15<00:03,  7.64it/s]
Evaluating...:  81%|████████  | 114/141 [00:15<00:03,  7.64it/s]
Evaluating...:  82%|████████▏ | 115/141 [00:15<00:03,  7.67it/s]
Evaluating...:  82%|████████▏ | 116/141 [00:15<00:03,  7.66it/s]
Evaluating...:  83%|████████▎ | 117/141 [00:15<00:03,  7.64it/s]
Evaluating...:  84%|████████▎ | 118/141 [00:15<00:03,  7.63it/s]
Evaluating...:  84%|████████▍ | 119/141 [00:15<00:02,  7.63it/s]
Evaluating...:  85%|████████▌ | 120/141 [00:15<00:02,  7.64it/s]
Evaluating...:  86%|████████▌ | 121/141 [00:16<00:02,  7.63it/s]
Evaluating...:  87%|████████▋ | 122/141 [00:16<00:02,  7.67it/s]
Evaluating...:  87%|████████▋ | 123/141 [00:16<00:02,  7.65it/s]
Evaluating...:  88%|████████▊ | 124/141 [00:16<00:02,  7.64it/s]
Evaluating...:  89%|████████▊ | 125/141 [00:16<00:02,  7.64it/s]
Evaluating...:  89%|████████▉ | 126/141 [00:16<00:01,  7.63it/s]
Evaluating...:  90%|█████████ | 127/141 [00:16<00:01,  7.63it/s]
Evaluating...:  91%|█████████ | 128/141 [00:17<00:01,  7.62it/s]
Evaluating...:  91%|█████████▏| 129/141 [00:17<00:01,  7.65it/s]
Evaluating...:  92%|█████████▏| 130/141 [00:17<00:01,  7.64it/s]
Evaluating...:  93%|█████████▎| 131/141 [00:17<00:01,  7.62it/s]
Evaluating...:  94%|█████████▎| 132/141 [00:17<00:01,  7.63it/s]
Evaluating...:  94%|█████████▍| 133/141 [00:17<00:01,  7.62it/s]
Evaluating...:  95%|█████████▌| 134/141 [00:17<00:00,  7.62it/s]
Evaluating...:  96%|█████████▌| 135/141 [00:17<00:00,  7.64it/s]
Evaluating...:  96%|█████████▋| 136/141 [00:18<00:00,  7.65it/s]
Evaluating...:  97%|█████████▋| 137/141 [00:18<00:00,  7.64it/s]
Evaluating...:  98%|█████████▊| 138/141 [00:18<00:00,  7.63it/s]
Evaluating...:  99%|█████████▊| 139/141 [00:18<00:00,  7.63it/s]
Evaluating...:  99%|█████████▉| 140/141 [00:18<00:00,  7.63it/s]
Evaluating...: 100%|██████████| 141/141 [00:18<00:00,  7.62it/s]
Evaluating...: 100%|██████████| 141/141 [00:18<00:00,  7.54it/s]
Perplexity: 6.503281593322754
Running with alpha=0.15
Token indices sequence length is longer than the specified maximum sequence length for this model (289077 > 131072). Running this sequence through the model will result in indexing errors

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.38s/it]
Loading checkpoint shards:  50%|█████     | 2/4 [00:06<00:06,  3.31s/it]
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:09<00:03,  3.24s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:10<00:00,  2.28s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:10<00:00,  2.65s/it]
/gemini/code/NMSparsity/smoothquant/smoothquant/ppl_eval.py:85: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  act_scales = torch.load(act_scales_path)

Evaluating...:   0%|          | 0/141 [00:00<?, ?it/s]
Evaluating...:   1%|          | 1/141 [00:00<01:03,  2.21it/s]
Evaluating...:   2%|▏         | 3/141 [00:00<00:26,  5.20it/s]
Evaluating...:   3%|▎         | 4/141 [00:00<00:23,  5.84it/s]
Evaluating...:   4%|▎         | 5/141 [00:00<00:20,  6.49it/s]
Evaluating...:   4%|▍         | 6/141 [00:01<00:21,  6.17it/s]
Evaluating...:   5%|▍         | 7/141 [00:01<00:19,  6.82it/s]
Evaluating...:   6%|▌         | 8/141 [00:01<00:18,  7.11it/s]
Evaluating...:   6%|▋         | 9/141 [00:01<00:17,  7.34it/s]
Evaluating...:   7%|▋         | 10/141 [00:01<00:18,  7.13it/s]
Evaluating...:   8%|▊         | 11/141 [00:01<00:17,  7.23it/s]
Evaluating...:   9%|▊         | 12/141 [00:01<00:17,  7.42it/s]
Evaluating...:   9%|▉         | 13/141 [00:01<00:16,  7.56it/s]
Evaluating...:  10%|▉         | 14/141 [00:02<00:15,  8.01it/s]
Evaluating...:  11%|█         | 15/141 [00:02<00:18,  6.89it/s]
Evaluating...:  11%|█▏        | 16/141 [00:02<00:19,  6.25it/s]
Evaluating...:  12%|█▏        | 17/141 [00:02<00:17,  6.93it/s]
Evaluating...:  13%|█▎        | 18/141 [00:02<00:16,  7.50it/s]
Evaluating...:  13%|█▎        | 19/141 [00:02<00:16,  7.61it/s]
Evaluating...:  14%|█▍        | 20/141 [00:02<00:15,  7.68it/s]
Evaluating...:  15%|█▍        | 21/141 [00:03<00:15,  7.71it/s]
Evaluating...:  16%|█▌        | 22/141 [00:03<00:15,  7.70it/s]
Evaluating...:  16%|█▋        | 23/141 [00:03<00:15,  7.72it/s]
Evaluating...:  17%|█▋        | 24/141 [00:03<00:15,  7.73it/s]
Evaluating...:  18%|█▊        | 25/141 [00:03<00:14,  7.94it/s]
Evaluating...:  18%|█▊        | 26/141 [00:03<00:14,  8.03it/s]
Evaluating...:  19%|█▉        | 27/141 [00:03<00:16,  6.75it/s]
Evaluating...:  20%|█▉        | 28/141 [00:04<00:18,  6.10it/s]
Evaluating...:  21%|██        | 29/141 [00:04<00:16,  6.80it/s]
Evaluating...:  21%|██▏       | 30/141 [00:04<00:15,  7.39it/s]
Evaluating...:  22%|██▏       | 31/141 [00:04<00:14,  7.72it/s]
Evaluating...:  23%|██▎       | 32/141 [00:04<00:14,  7.71it/s]
Evaluating...:  23%|██▎       | 33/141 [00:04<00:13,  7.72it/s]
Evaluating...:  24%|██▍       | 34/141 [00:04<00:13,  8.02it/s]
Evaluating...:  25%|██▍       | 35/141 [00:04<00:14,  7.15it/s]
Evaluating...:  26%|██▌       | 36/141 [00:05<00:15,  6.65it/s]
Evaluating...:  26%|██▌       | 37/141 [00:05<00:14,  7.27it/s]
Evaluating...:  27%|██▋       | 38/141 [00:05<00:13,  7.57it/s]
Evaluating...:  28%|██▊       | 39/141 [00:05<00:13,  7.61it/s]
Evaluating...:  28%|██▊       | 40/141 [00:05<00:13,  7.64it/s]
Evaluating...:  29%|██▉       | 41/141 [00:05<00:13,  7.67it/s]
Evaluating...:  30%|██▉       | 42/141 [00:05<00:12,  8.09it/s]
Evaluating...:  30%|███       | 43/141 [00:06<00:13,  7.04it/s]
Evaluating...:  31%|███       | 44/141 [00:06<00:14,  6.56it/s]
Evaluating...:  32%|███▏      | 45/141 [00:06<00:13,  7.19it/s]
Evaluating...:  33%|███▎      | 46/141 [00:06<00:12,  7.58it/s]
Evaluating...:  33%|███▎      | 47/141 [00:06<00:12,  7.62it/s]
Evaluating...:  34%|███▍      | 48/141 [00:06<00:12,  7.64it/s]
Evaluating...:  35%|███▍      | 49/141 [00:06<00:12,  7.59it/s]
Evaluating...:  35%|███▌      | 50/141 [00:06<00:11,  7.64it/s]
Evaluating...:  36%|███▌      | 51/141 [00:07<00:11,  7.65it/s]
Evaluating...:  37%|███▋      | 52/141 [00:07<00:11,  7.67it/s]
Evaluating...:  38%|███▊      | 53/141 [00:07<00:11,  7.68it/s]
Evaluating...:  38%|███▊      | 54/141 [00:07<00:11,  7.71it/s]
Evaluating...:  39%|███▉      | 55/141 [00:07<00:11,  7.72it/s]
Evaluating...:  40%|███▉      | 56/141 [00:07<00:10,  7.81it/s]
Evaluating...:  40%|████      | 57/141 [00:07<00:11,  7.36it/s]
Evaluating...:  41%|████      | 58/141 [00:08<00:11,  7.32it/s]
Evaluating...:  42%|████▏     | 59/141 [00:08<00:10,  7.54it/s]
Evaluating...:  43%|████▎     | 60/141 [00:08<00:10,  7.60it/s]
Evaluating...:  43%|████▎     | 61/141 [00:08<00:10,  7.65it/s]
Evaluating...:  44%|████▍     | 62/141 [00:08<00:11,  6.88it/s]
Evaluating...:  45%|████▍     | 63/141 [00:08<00:10,  7.40it/s]
Evaluating...:  45%|████▌     | 64/141 [00:08<00:10,  7.68it/s]
Evaluating...:  46%|████▌     | 65/141 [00:09<00:11,  6.85it/s]
Evaluating...:  47%|████▋     | 66/141 [00:09<00:10,  7.16it/s]
Evaluating...:  48%|████▊     | 67/141 [00:09<00:09,  7.49it/s]
Evaluating...:  48%|████▊     | 68/141 [00:09<00:09,  7.57it/s]
Evaluating...:  49%|████▉     | 69/141 [00:09<00:09,  7.61it/s]
Evaluating...:  50%|████▉     | 70/141 [00:09<00:09,  7.65it/s]
Evaluating...:  50%|█████     | 71/141 [00:09<00:09,  7.71it/s]
Evaluating...:  51%|█████     | 72/141 [00:09<00:08,  7.70it/s]
Evaluating...:  52%|█████▏    | 73/141 [00:10<00:10,  6.72it/s]
Evaluating...:  52%|█████▏    | 74/141 [00:10<00:09,  7.31it/s]
Evaluating...:  53%|█████▎    | 75/141 [00:10<00:08,  7.81it/s]
Evaluating...:  54%|█████▍    | 76/141 [00:10<00:09,  7.04it/s]
Evaluating...:  55%|█████▍    | 77/141 [00:10<00:09,  6.97it/s]
Evaluating...:  55%|█████▌    | 78/141 [00:10<00:08,  7.47it/s]
Evaluating...:  56%|█████▌    | 79/141 [00:10<00:08,  7.53it/s]
Evaluating...:  57%|█████▋    | 80/141 [00:11<00:08,  7.60it/s]
Evaluating...:  57%|█████▋    | 81/141 [00:11<00:07,  7.63it/s]
Evaluating...:  58%|█████▊    | 82/141 [00:11<00:07,  7.65it/s]
Evaluating...:  59%|█████▉    | 83/141 [00:11<00:07,  7.67it/s]
Evaluating...:  60%|█████▉    | 84/141 [00:11<00:07,  7.70it/s]
Evaluating...:  60%|██████    | 85/141 [00:11<00:07,  7.71it/s]
Evaluating...:  61%|██████    | 86/141 [00:11<00:07,  7.71it/s]
Evaluating...:  62%|██████▏   | 87/141 [00:11<00:07,  7.71it/s]
Evaluating...:  62%|██████▏   | 88/141 [00:12<00:06,  7.72it/s]
Evaluating...:  63%|██████▎   | 89/141 [00:12<00:06,  7.74it/s]
Evaluating...:  64%|██████▍   | 90/141 [00:12<00:06,  8.02it/s]
Evaluating...:  65%|██████▍   | 91/141 [00:12<00:06,  7.18it/s]
Evaluating...:  65%|██████▌   | 92/141 [00:12<00:07,  6.70it/s]
Evaluating...:  66%|██████▌   | 93/141 [00:12<00:06,  7.31it/s]
Evaluating...:  67%|██████▋   | 94/141 [00:12<00:06,  7.57it/s]
Evaluating...:  67%|██████▋   | 95/141 [00:13<00:06,  7.62it/s]
Evaluating...:  68%|██████▊   | 96/141 [00:13<00:05,  7.99it/s]
Evaluating...:  69%|██████▉   | 97/141 [00:13<00:05,  8.35it/s]
Evaluating...:  70%|██████▉   | 98/141 [00:13<00:06,  6.80it/s]
Evaluating...:  70%|███████   | 99/141 [00:13<00:06,  6.02it/s]
Evaluating...:  71%|███████   | 100/141 [00:13<00:06,  5.86it/s]
Evaluating...:  72%|███████▏  | 101/141 [00:13<00:06,  6.59it/s]
Evaluating...:  72%|███████▏  | 102/141 [00:14<00:05,  7.22it/s]
Evaluating...:  73%|███████▎  | 103/141 [00:14<00:04,  7.74it/s]
Evaluating...:  74%|███████▍  | 104/141 [00:14<00:04,  7.87it/s]
Evaluating...:  74%|███████▍  | 105/141 [00:14<00:04,  7.83it/s]
Evaluating...:  75%|███████▌  | 106/141 [00:14<00:04,  7.80it/s]
Evaluating...:  76%|███████▌  | 107/141 [00:14<00:04,  7.80it/s]
Evaluating...:  77%|███████▋  | 108/141 [00:14<00:04,  7.81it/s]
Evaluating...:  77%|███████▋  | 109/141 [00:14<00:04,  7.79it/s]
Evaluating...:  78%|███████▊  | 110/141 [00:15<00:03,  7.85it/s]
Evaluating...:  79%|███████▊  | 111/141 [00:15<00:04,  7.39it/s]
Evaluating...:  79%|███████▉  | 112/141 [00:15<00:03,  7.34it/s]
Evaluating...:  80%|████████  | 113/141 [00:15<00:03,  7.82it/s]
Evaluating...:  81%|████████  | 114/141 [00:15<00:03,  6.95it/s]
Evaluating...:  82%|████████▏ | 115/141 [00:15<00:03,  7.13it/s]
Evaluating...:  82%|████████▏ | 116/141 [00:15<00:03,  7.46it/s]
Evaluating...:  83%|████████▎ | 117/141 [00:16<00:03,  7.55it/s]
Evaluating...:  84%|████████▎ | 118/141 [00:16<00:03,  7.62it/s]
Evaluating...:  84%|████████▍ | 119/141 [00:16<00:03,  7.05it/s]
Evaluating...:  85%|████████▌ | 120/141 [00:16<00:02,  7.53it/s]
Evaluating...:  86%|████████▌ | 121/141 [00:16<00:02,  7.58it/s]
Evaluating...:  87%|████████▋ | 122/141 [00:16<00:02,  7.80it/s]
Evaluating...:  87%|████████▋ | 123/141 [00:16<00:02,  7.17it/s]
Evaluating...:  88%|████████▊ | 124/141 [00:16<00:02,  6.95it/s]
Evaluating...:  89%|████████▊ | 125/141 [00:17<00:02,  7.48it/s]
Evaluating...:  89%|████████▉ | 126/141 [00:17<00:01,  7.56it/s]
Evaluating...:  90%|█████████ | 127/141 [00:17<00:01,  7.60it/s]
Evaluating...:  91%|█████████ | 128/141 [00:17<00:01,  7.82it/s]
Evaluating...:  91%|█████████▏| 129/141 [00:17<00:01,  7.14it/s]
Evaluating...:  92%|█████████▏| 130/141 [00:17<00:01,  7.48it/s]
Evaluating...:  93%|█████████▎| 131/141 [00:17<00:01,  7.56it/s]
Evaluating...:  94%|█████████▎| 132/141 [00:18<00:01,  7.62it/s]
Evaluating...:  94%|█████████▍| 133/141 [00:18<00:01,  7.64it/s]
Evaluating...:  95%|█████████▌| 134/141 [00:18<00:00,  7.66it/s]
Evaluating...:  96%|█████████▌| 135/141 [00:18<00:00,  7.69it/s]
Evaluating...:  96%|█████████▋| 136/141 [00:18<00:00,  8.01it/s]
Evaluating...:  97%|█████████▋| 137/141 [00:18<00:00,  7.24it/s]
Evaluating...:  98%|█████████▊| 138/141 [00:18<00:00,  6.39it/s]
Evaluating...:  99%|█████████▊| 139/141 [00:18<00:00,  7.04it/s]
Evaluating...:  99%|█████████▉| 140/141 [00:19<00:00,  7.60it/s]
Evaluating...: 100%|██████████| 141/141 [00:19<00:00,  7.64it/s]
Evaluating...: 100%|██████████| 141/141 [00:19<00:00,  7.33it/s]
Perplexity: 6.412710189819336
Running with alpha=0.25
Token indices sequence length is longer than the specified maximum sequence length for this model (289077 > 131072). Running this sequence through the model will result in indexing errors

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:11,  3.73s/it]
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.50s/it]
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:10<00:03,  3.38s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:11<00:00,  2.37s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:11<00:00,  2.78s/it]
/gemini/code/NMSparsity/smoothquant/smoothquant/ppl_eval.py:85: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  act_scales = torch.load(act_scales_path)

Evaluating...:   0%|          | 0/141 [00:00<?, ?it/s]
Evaluating...:   1%|          | 1/141 [00:00<00:49,  2.82it/s]
Evaluating...:   2%|▏         | 3/141 [00:00<00:23,  5.77it/s]
Evaluating...:   3%|▎         | 4/141 [00:00<00:21,  6.31it/s]
Evaluating...:   4%|▎         | 5/141 [00:00<00:20,  6.72it/s]
Evaluating...:   4%|▍         | 6/141 [00:00<00:19,  7.02it/s]
Evaluating...:   5%|▍         | 7/141 [00:01<00:18,  7.22it/s]
Evaluating...:   6%|▌         | 8/141 [00:01<00:18,  7.35it/s]
Evaluating...:   6%|▋         | 9/141 [00:01<00:17,  7.44it/s]
Evaluating...:   7%|▋         | 10/141 [00:01<00:17,  7.46it/s]
Evaluating...:   8%|▊         | 11/141 [00:01<00:17,  7.51it/s]
Evaluating...:   9%|▊         | 12/141 [00:01<00:17,  7.56it/s]
Evaluating...:   9%|▉         | 13/141 [00:01<00:16,  7.62it/s]
Evaluating...:  10%|▉         | 14/141 [00:02<00:16,  7.63it/s]
Evaluating...:  11%|█         | 15/141 [00:02<00:16,  7.65it/s]
Evaluating...:  11%|█▏        | 16/141 [00:02<00:16,  7.68it/s]
Evaluating...:  12%|█▏        | 17/141 [00:02<00:16,  7.68it/s]
Evaluating...:  13%|█▎        | 18/141 [00:02<00:16,  7.69it/s]
Evaluating...:  13%|█▎        | 19/141 [00:02<00:15,  7.69it/s]
Evaluating...:  14%|█▍        | 20/141 [00:02<00:15,  7.70it/s]
Evaluating...:  15%|█▍        | 21/141 [00:02<00:15,  7.69it/s]
Evaluating...:  16%|█▌        | 22/141 [00:03<00:15,  7.70it/s]
Evaluating...:  16%|█▋        | 23/141 [00:03<00:15,  7.71it/s]
Evaluating...:  17%|█▋        | 24/141 [00:03<00:15,  7.72it/s]
Evaluating...:  18%|█▊        | 25/141 [00:03<00:15,  7.71it/s]
Evaluating...:  18%|█▊        | 26/141 [00:03<00:14,  7.72it/s]
Evaluating...:  19%|█▉        | 27/141 [00:03<00:14,  7.71it/s]
Evaluating...:  20%|█▉        | 28/141 [00:03<00:14,  7.70it/s]
Evaluating...:  21%|██        | 29/141 [00:03<00:13,  8.03it/s]
Evaluating...:  21%|██▏       | 30/141 [00:04<00:14,  7.46it/s]
Evaluating...:  22%|██▏       | 31/141 [00:04<00:17,  6.41it/s]
Evaluating...:  23%|██▎       | 32/141 [00:04<00:16,  6.55it/s]
Evaluating...:  23%|██▎       | 33/141 [00:04<00:15,  7.19it/s]
Evaluating...:  24%|██▍       | 34/141 [00:04<00:13,  7.67it/s]
Evaluating...:  25%|██▍       | 35/141 [00:04<00:13,  7.69it/s]
Evaluating...:  26%|██▌       | 36/141 [00:04<00:13,  7.71it/s]
Evaluating...:  26%|██▌       | 37/141 [00:05<00:13,  7.70it/s]
Evaluating...:  27%|██▋       | 38/141 [00:05<00:13,  7.72it/s]
Evaluating...:  28%|██▊       | 39/141 [00:05<00:13,  7.72it/s]
Evaluating...:  28%|██▊       | 40/141 [00:05<00:13,  7.73it/s]
Evaluating...:  29%|██▉       | 41/141 [00:05<00:12,  7.73it/s]
Evaluating...:  30%|██▉       | 42/141 [00:05<00:12,  7.77it/s]
Evaluating...:  30%|███       | 43/141 [00:05<00:13,  7.54it/s]
Evaluating...:  31%|███       | 44/141 [00:05<00:13,  7.38it/s]
Evaluating...:  32%|███▏      | 45/141 [00:06<00:12,  7.58it/s]
Evaluating...:  33%|███▎      | 46/141 [00:06<00:12,  7.62it/s]
Evaluating...:  33%|███▎      | 47/141 [00:06<00:12,  7.67it/s]
Evaluating...:  34%|███▍      | 48/141 [00:06<00:12,  7.70it/s]
Evaluating...:  35%|███▍      | 49/141 [00:06<00:11,  7.70it/s]
Evaluating...:  35%|███▌      | 50/141 [00:06<00:11,  7.70it/s]
Evaluating...:  36%|███▌      | 51/141 [00:06<00:11,  7.71it/s]
Evaluating...:  37%|███▋      | 52/141 [00:07<00:11,  7.70it/s]
Evaluating...:  38%|███▊      | 53/141 [00:07<00:11,  7.71it/s]
Evaluating...:  38%|███▊      | 54/141 [00:07<00:11,  7.74it/s]
Evaluating...:  39%|███▉      | 55/141 [00:07<00:11,  7.73it/s]
Evaluating...:  40%|███▉      | 56/141 [00:07<00:11,  7.72it/s]
Evaluating...:  40%|████      | 57/141 [00:07<00:10,  7.72it/s]
Evaluating...:  41%|████      | 58/141 [00:07<00:10,  7.72it/s]
Evaluating...:  42%|████▏     | 59/141 [00:07<00:10,  7.71it/s]
Evaluating...:  43%|████▎     | 60/141 [00:08<00:10,  7.70it/s]
Evaluating...:  43%|████▎     | 61/141 [00:08<00:10,  7.73it/s]
Evaluating...:  44%|████▍     | 62/141 [00:08<00:10,  7.73it/s]
Evaluating...:  45%|████▍     | 63/141 [00:08<00:10,  7.74it/s]
Evaluating...:  45%|████▌     | 64/141 [00:08<00:09,  7.72it/s]
Evaluating...:  46%|████▌     | 65/141 [00:08<00:09,  7.92it/s]
Evaluating...:  47%|████▋     | 66/141 [00:08<00:09,  8.29it/s]
Evaluating...:  48%|████▊     | 67/141 [00:08<00:10,  6.97it/s]
Evaluating...:  48%|████▊     | 68/141 [00:09<00:11,  6.12it/s]
Evaluating...:  49%|████▉     | 69/141 [00:09<00:11,  6.08it/s]
Evaluating...:  50%|████▉     | 70/141 [00:09<00:10,  6.78it/s]
Evaluating...:  50%|█████     | 71/141 [00:09<00:09,  7.37it/s]
Evaluating...:  51%|█████     | 72/141 [00:09<00:08,  7.82it/s]
Evaluating...:  52%|█████▏    | 73/141 [00:09<00:08,  7.79it/s]
Evaluating...:  52%|█████▏    | 74/141 [00:09<00:08,  7.78it/s]
Evaluating...:  53%|█████▎    | 75/141 [00:10<00:08,  7.76it/s]
Evaluating...:  54%|█████▍    | 76/141 [00:10<00:08,  7.74it/s]
Evaluating...:  55%|█████▍    | 77/141 [00:10<00:08,  7.74it/s]
Evaluating...:  55%|█████▌    | 78/141 [00:10<00:08,  7.73it/s]
Evaluating...:  56%|█████▌    | 79/141 [00:10<00:08,  7.72it/s]
Evaluating...:  57%|█████▋    | 80/141 [00:10<00:07,  7.76it/s]
Evaluating...:  57%|█████▋    | 81/141 [00:10<00:07,  7.75it/s]
Evaluating...:  58%|█████▊    | 82/141 [00:10<00:07,  7.74it/s]
Evaluating...:  59%|█████▉    | 83/141 [00:11<00:07,  7.73it/s]
Evaluating...:  60%|█████▉    | 84/141 [00:11<00:07,  7.71it/s]
Evaluating...:  60%|██████    | 85/141 [00:11<00:07,  7.70it/s]
Evaluating...:  61%|██████    | 86/141 [00:11<00:07,  7.71it/s]
Evaluating...:  62%|██████▏   | 87/141 [00:11<00:06,  7.72it/s]
Evaluating...:  62%|██████▏   | 88/141 [00:11<00:06,  7.73it/s]
Evaluating...:  63%|██████▎   | 89/141 [00:11<00:06,  7.76it/s]
Evaluating...:  64%|██████▍   | 90/141 [00:12<00:06,  7.74it/s]
Evaluating...:  65%|██████▍   | 91/141 [00:12<00:06,  7.74it/s]
Evaluating...:  65%|██████▌   | 92/141 [00:12<00:06,  7.73it/s]
Evaluating...:  66%|██████▌   | 93/141 [00:12<00:06,  7.71it/s]
Evaluating...:  67%|██████▋   | 94/141 [00:12<00:06,  7.72it/s]
Evaluating...:  67%|██████▋   | 95/141 [00:12<00:05,  7.71it/s]
Evaluating...:  68%|██████▊   | 96/141 [00:12<00:05,  7.71it/s]
Evaluating...:  69%|██████▉   | 97/141 [00:12<00:05,  7.73it/s]
Evaluating...:  70%|██████▉   | 98/141 [00:13<00:05,  7.75it/s]
Evaluating...:  70%|███████   | 99/141 [00:13<00:05,  7.74it/s]
Evaluating...:  71%|███████   | 100/141 [00:13<00:05,  7.83it/s]
Evaluating...:  72%|███████▏  | 101/141 [00:13<00:04,  8.22it/s]
Evaluating...:  72%|███████▏  | 102/141 [00:13<00:05,  7.22it/s]
Evaluating...:  73%|███████▎  | 103/141 [00:13<00:06,  6.24it/s]
Evaluating...:  74%|███████▍  | 104/141 [00:13<00:06,  6.16it/s]
Evaluating...:  74%|███████▍  | 105/141 [00:14<00:05,  6.86it/s]
Evaluating...:  75%|███████▌  | 106/141 [00:14<00:04,  7.44it/s]
Evaluating...:  76%|███████▌  | 107/141 [00:14<00:04,  7.76it/s]
Evaluating...:  77%|███████▋  | 108/141 [00:14<00:04,  7.74it/s]
Evaluating...:  77%|███████▋  | 109/141 [00:14<00:04,  7.72it/s]
Evaluating...:  78%|███████▊  | 110/141 [00:14<00:04,  7.73it/s]
Evaluating...:  79%|███████▊  | 111/141 [00:14<00:03,  7.72it/s]
Evaluating...:  79%|███████▉  | 112/141 [00:14<00:03,  7.73it/s]
Evaluating...:  80%|████████  | 113/141 [00:15<00:03,  7.75it/s]
Evaluating...:  81%|████████  | 114/141 [00:15<00:03,  7.73it/s]
Evaluating...:  82%|████████▏ | 115/141 [00:15<00:03,  7.73it/s]
Evaluating...:  82%|████████▏ | 116/141 [00:15<00:03,  7.71it/s]
Evaluating...:  83%|████████▎ | 117/141 [00:15<00:03,  7.70it/s]
Evaluating...:  84%|████████▎ | 118/141 [00:15<00:02,  7.70it/s]
Evaluating...:  84%|████████▍ | 119/141 [00:15<00:02,  7.68it/s]
Evaluating...:  85%|████████▌ | 120/141 [00:15<00:02,  7.69it/s]
Evaluating...:  86%|████████▌ | 121/141 [00:16<00:02,  7.74it/s]
Evaluating...:  87%|████████▋ | 122/141 [00:16<00:02,  7.73it/s]
Evaluating...:  87%|████████▋ | 123/141 [00:16<00:02,  7.72it/s]
Evaluating...:  88%|████████▊ | 124/141 [00:16<00:02,  7.71it/s]
Evaluating...:  89%|████████▊ | 125/141 [00:16<00:02,  7.70it/s]
Evaluating...:  89%|████████▉ | 126/141 [00:16<00:01,  7.70it/s]
Evaluating...:  90%|█████████ | 127/141 [00:16<00:01,  7.70it/s]
Evaluating...:  91%|█████████ | 128/141 [00:17<00:01,  7.70it/s]
Evaluating...:  91%|█████████▏| 129/141 [00:17<00:01,  7.72it/s]
Evaluating...:  92%|█████████▏| 130/141 [00:17<00:01,  7.74it/s]
Evaluating...:  93%|█████████▎| 131/141 [00:17<00:01,  7.74it/s]
Evaluating...:  94%|█████████▎| 132/141 [00:17<00:01,  7.72it/s]
Evaluating...:  94%|█████████▍| 133/141 [00:17<00:01,  7.73it/s]
Evaluating...:  95%|█████████▌| 134/141 [00:17<00:00,  7.70it/s]
Evaluating...:  96%|█████████▌| 135/141 [00:17<00:00,  7.71it/s]
Evaluating...:  96%|█████████▋| 136/141 [00:18<00:00,  7.71it/s]
Evaluating...:  97%|█████████▋| 137/141 [00:18<00:00,  7.70it/s]
Evaluating...:  98%|█████████▊| 138/141 [00:18<00:00,  7.74it/s]
Evaluating...:  99%|█████████▊| 139/141 [00:18<00:00,  7.74it/s]
Evaluating...:  99%|█████████▉| 140/141 [00:18<00:00,  7.73it/s]
Evaluating...: 100%|██████████| 141/141 [00:18<00:00,  7.73it/s]
Evaluating...: 100%|██████████| 141/141 [00:18<00:00,  7.54it/s]
Perplexity: 6.3905768394470215
Running with alpha=0.5
Token indices sequence length is longer than the specified maximum sequence length for this model (289077 > 131072). Running this sequence through the model will result in indexing errors

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.66s/it]
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.54s/it]
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:10<00:03,  3.63s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:11<00:00,  2.53s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:11<00:00,  2.92s/it]
/gemini/code/NMSparsity/smoothquant/smoothquant/ppl_eval.py:86: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  act_scales = torch.load(act_scales_path)
smooth...
quantize...

Evaluating...:   0%|          | 0/141 [00:00<?, ?it/s]
Evaluating...:   1%|          | 1/141 [00:00<00:58,  2.40it/s]
Evaluating...:   2%|▏         | 3/141 [00:00<00:26,  5.29it/s]
Evaluating...:   3%|▎         | 4/141 [00:00<00:23,  5.94it/s]
Evaluating...:   4%|▎         | 5/141 [00:00<00:21,  6.45it/s]
Evaluating...:   4%|▍         | 6/141 [00:01<00:19,  6.80it/s]
Evaluating...:   5%|▍         | 7/141 [00:01<00:19,  7.05it/s]
Evaluating...:   6%|▌         | 8/141 [00:01<00:18,  7.24it/s]
Evaluating...:   6%|▋         | 9/141 [00:01<00:17,  7.37it/s]
Evaluating...:   7%|▋         | 10/141 [00:01<00:17,  7.48it/s]
Evaluating...:   8%|▊         | 11/141 [00:01<00:17,  7.54it/s]
Evaluating...:   9%|▊         | 12/141 [00:01<00:16,  7.62it/s]
Evaluating...:   9%|▉         | 13/141 [00:01<00:16,  7.63it/s]
Evaluating...:  10%|▉         | 14/141 [00:02<00:16,  7.66it/s]
Evaluating...:  11%|█         | 15/141 [00:02<00:16,  7.65it/s]
Evaluating...:  11%|█▏        | 16/141 [00:02<00:16,  7.66it/s]
Evaluating...:  12%|█▏        | 17/141 [00:02<00:16,  7.66it/s]
Evaluating...:  13%|█▎        | 18/141 [00:02<00:16,  7.68it/s]
Evaluating...:  13%|█▎        | 19/141 [00:02<00:15,  7.71it/s]
Evaluating...:  14%|█▍        | 20/141 [00:02<00:15,  7.71it/s]
Evaluating...:  15%|█▍        | 21/141 [00:02<00:15,  7.70it/s]
Evaluating...:  16%|█▌        | 22/141 [00:03<00:15,  7.70it/s]
Evaluating...:  16%|█▋        | 23/141 [00:03<00:15,  7.69it/s]
Evaluating...:  17%|█▋        | 24/141 [00:03<00:15,  7.69it/s]
Evaluating...:  18%|█▊        | 25/141 [00:03<00:15,  7.69it/s]
Evaluating...:  18%|█▊        | 26/141 [00:03<00:14,  7.72it/s]
Evaluating...:  19%|█▉        | 27/141 [00:03<00:14,  7.71it/s]
Evaluating...:  20%|█▉        | 28/141 [00:03<00:14,  7.70it/s]
Evaluating...:  21%|██        | 29/141 [00:04<00:14,  7.70it/s]
Evaluating...:  21%|██▏       | 30/141 [00:04<00:14,  7.69it/s]
Evaluating...:  22%|██▏       | 31/141 [00:04<00:14,  7.70it/s]
Evaluating...:  23%|██▎       | 32/141 [00:04<00:14,  7.68it/s]
Evaluating...:  23%|██▎       | 33/141 [00:04<00:14,  7.71it/s]
Evaluating...:  24%|██▍       | 34/141 [00:04<00:13,  7.71it/s]
Evaluating...:  25%|██▍       | 35/141 [00:04<00:13,  7.71it/s]
Evaluating...:  26%|██▌       | 36/141 [00:04<00:13,  7.70it/s]
Evaluating...:  26%|██▌       | 37/141 [00:05<00:13,  7.70it/s]
Evaluating...:  27%|██▋       | 38/141 [00:05<00:13,  7.70it/s]
Evaluating...:  28%|██▊       | 39/141 [00:05<00:13,  7.69it/s]
Evaluating...:  28%|██▊       | 40/141 [00:05<00:13,  7.72it/s]
Evaluating...:  29%|██▉       | 41/141 [00:05<00:12,  7.71it/s]
Evaluating...:  30%|██▉       | 42/141 [00:05<00:12,  7.71it/s]
Evaluating...:  30%|███       | 43/141 [00:05<00:12,  7.70it/s]
Evaluating...:  31%|███       | 44/141 [00:05<00:12,  7.69it/s]
Evaluating...:  32%|███▏      | 45/141 [00:06<00:12,  7.69it/s]
Evaluating...:  33%|███▎      | 46/141 [00:06<00:12,  7.68it/s]
Evaluating...:  33%|███▎      | 47/141 [00:06<00:12,  7.71it/s]
Evaluating...:  34%|███▍      | 48/141 [00:06<00:12,  7.69it/s]
Evaluating...:  35%|███▍      | 49/141 [00:06<00:11,  7.70it/s]
Evaluating...:  35%|███▌      | 50/141 [00:06<00:11,  7.68it/s]
Evaluating...:  36%|███▌      | 51/141 [00:06<00:11,  7.68it/s]
Evaluating...:  37%|███▋      | 52/141 [00:06<00:11,  7.68it/s]
Evaluating...:  38%|███▊      | 53/141 [00:07<00:11,  7.68it/s]
Evaluating...:  38%|███▊      | 54/141 [00:07<00:11,  7.71it/s]
Evaluating...:  39%|███▉      | 55/141 [00:07<00:11,  7.70it/s]
Evaluating...:  40%|███▉      | 56/141 [00:07<00:11,  7.68it/s]
Evaluating...:  40%|████      | 57/141 [00:07<00:10,  7.69it/s]
Evaluating...:  41%|████      | 58/141 [00:07<00:10,  7.68it/s]
Evaluating...:  42%|████▏     | 59/141 [00:07<00:10,  7.69it/s]
Evaluating...:  43%|████▎     | 60/141 [00:08<00:10,  7.68it/s]
Evaluating...:  43%|████▎     | 61/141 [00:08<00:10,  7.70it/s]
Evaluating...:  44%|████▍     | 62/141 [00:08<00:10,  7.70it/s]
Evaluating...:  45%|████▍     | 63/141 [00:08<00:10,  7.68it/s]
Evaluating...:  45%|████▌     | 64/141 [00:08<00:10,  7.69it/s]
Evaluating...:  46%|████▌     | 65/141 [00:08<00:09,  7.69it/s]
Evaluating...:  47%|████▋     | 66/141 [00:08<00:09,  7.69it/s]
Evaluating...:  48%|████▊     | 67/141 [00:08<00:09,  7.68it/s]
Evaluating...:  48%|████▊     | 68/141 [00:09<00:09,  7.72it/s]
Evaluating...:  49%|████▉     | 69/141 [00:09<00:09,  7.70it/s]
Evaluating...:  50%|████▉     | 70/141 [00:09<00:09,  7.69it/s]
Evaluating...:  50%|█████     | 71/141 [00:09<00:09,  7.68it/s]
Evaluating...:  51%|█████     | 72/141 [00:09<00:08,  7.69it/s]
Evaluating...:  52%|█████▏    | 73/141 [00:09<00:08,  7.69it/s]
Evaluating...:  52%|█████▏    | 74/141 [00:09<00:08,  7.68it/s]
Evaluating...:  53%|█████▎    | 75/141 [00:09<00:08,  7.72it/s]
Evaluating...:  54%|█████▍    | 76/141 [00:10<00:08,  7.71it/s]
Evaluating...:  55%|█████▍    | 77/141 [00:10<00:08,  7.70it/s]
Evaluating...:  55%|█████▌    | 78/141 [00:10<00:08,  7.69it/s]
Evaluating...:  56%|█████▌    | 79/141 [00:10<00:08,  7.69it/s]
Evaluating...:  57%|█████▋    | 80/141 [00:10<00:07,  7.69it/s]
Evaluating...:  57%|█████▋    | 81/141 [00:10<00:07,  7.68it/s]
Evaluating...:  58%|█████▊    | 82/141 [00:10<00:07,  7.71it/s]
Evaluating...:  59%|█████▉    | 83/141 [00:11<00:07,  7.70it/s]
Evaluating...:  60%|█████▉    | 84/141 [00:11<00:07,  7.69it/s]
Evaluating...:  60%|██████    | 85/141 [00:11<00:07,  7.68it/s]
Evaluating...:  61%|██████    | 86/141 [00:11<00:07,  7.67it/s]
Evaluating...:  62%|██████▏   | 87/141 [00:11<00:07,  7.69it/s]
Evaluating...:  62%|██████▏   | 88/141 [00:11<00:06,  7.69it/s]
Evaluating...:  63%|██████▎   | 89/141 [00:11<00:06,  7.72it/s]
Evaluating...:  64%|██████▍   | 90/141 [00:11<00:06,  7.71it/s]
Evaluating...:  65%|██████▍   | 91/141 [00:12<00:06,  7.70it/s]
Evaluating...:  65%|██████▌   | 92/141 [00:12<00:06,  7.69it/s]
Evaluating...:  66%|██████▌   | 93/141 [00:12<00:06,  7.69it/s]
Evaluating...:  67%|██████▋   | 94/141 [00:12<00:06,  7.70it/s]
Evaluating...:  67%|██████▋   | 95/141 [00:12<00:05,  7.69it/s]
Evaluating...:  68%|██████▊   | 96/141 [00:12<00:05,  7.72it/s]
Evaluating...:  69%|██████▉   | 97/141 [00:12<00:05,  7.71it/s]
Evaluating...:  70%|██████▉   | 98/141 [00:12<00:05,  7.69it/s]
Evaluating...:  70%|███████   | 99/141 [00:13<00:05,  7.69it/s]
Evaluating...:  71%|███████   | 100/141 [00:13<00:05,  7.70it/s]
Evaluating...:  72%|███████▏  | 101/141 [00:13<00:05,  7.70it/s]
Evaluating...:  72%|███████▏  | 102/141 [00:13<00:05,  7.69it/s]
Evaluating...:  73%|███████▎  | 103/141 [00:13<00:04,  7.72it/s]
Evaluating...:  74%|███████▍  | 104/141 [00:13<00:04,  7.70it/s]
Evaluating...:  74%|███████▍  | 105/141 [00:13<00:04,  7.70it/s]
Evaluating...:  75%|███████▌  | 106/141 [00:14<00:04,  7.70it/s]
Evaluating...:  76%|███████▌  | 107/141 [00:14<00:04,  7.70it/s]
Evaluating...:  77%|███████▋  | 108/141 [00:14<00:04,  7.69it/s]
Evaluating...:  77%|███████▋  | 109/141 [00:14<00:04,  7.69it/s]
Evaluating...:  78%|███████▊  | 110/141 [00:14<00:04,  7.73it/s]
Evaluating...:  79%|███████▊  | 111/141 [00:14<00:03,  7.72it/s]
Evaluating...:  79%|███████▉  | 112/141 [00:14<00:03,  7.71it/s]
Evaluating...:  80%|████████  | 113/141 [00:14<00:03,  7.69it/s]
Evaluating...:  81%|████████  | 114/141 [00:15<00:03,  7.69it/s]
Evaluating...:  82%|████████▏ | 115/141 [00:15<00:03,  7.69it/s]
Evaluating...:  82%|████████▏ | 116/141 [00:15<00:03,  7.69it/s]
Evaluating...:  83%|████████▎ | 117/141 [00:15<00:03,  7.73it/s]
Evaluating...:  84%|████████▎ | 118/141 [00:15<00:02,  7.72it/s]
Evaluating...:  84%|████████▍ | 119/141 [00:15<00:02,  7.72it/s]
Evaluating...:  85%|████████▌ | 120/141 [00:15<00:02,  7.72it/s]
Evaluating...:  86%|████████▌ | 121/141 [00:15<00:02,  7.72it/s]
Evaluating...:  87%|████████▋ | 122/141 [00:16<00:02,  7.71it/s]
Evaluating...:  87%|████████▋ | 123/141 [00:16<00:02,  7.71it/s]
Evaluating...:  88%|████████▊ | 124/141 [00:16<00:02,  7.76it/s]
Evaluating...:  89%|████████▊ | 125/141 [00:16<00:02,  7.74it/s]
Evaluating...:  89%|████████▉ | 126/141 [00:16<00:01,  7.74it/s]
Evaluating...:  90%|█████████ | 127/141 [00:16<00:01,  7.71it/s]
Evaluating...:  91%|█████████ | 128/141 [00:16<00:01,  7.71it/s]
Evaluating...:  91%|█████████▏| 129/141 [00:16<00:01,  7.70it/s]
Evaluating...:  92%|█████████▏| 130/141 [00:17<00:01,  7.72it/s]
Evaluating...:  93%|█████████▎| 131/141 [00:17<00:01,  7.73it/s]
Evaluating...:  94%|█████████▎| 132/141 [00:17<00:01,  7.73it/s]
Evaluating...:  94%|█████████▍| 133/141 [00:17<00:01,  7.72it/s]
Evaluating...:  95%|█████████▌| 134/141 [00:17<00:00,  7.72it/s]
Evaluating...:  96%|█████████▌| 135/141 [00:17<00:00,  7.71it/s]
Evaluating...:  96%|█████████▋| 136/141 [00:17<00:00,  7.73it/s]
Evaluating...:  97%|█████████▋| 137/141 [00:18<00:00,  7.70it/s]
Evaluating...:  98%|█████████▊| 138/141 [00:18<00:00,  7.72it/s]
Evaluating...:  99%|█████████▊| 139/141 [00:18<00:00,  7.75it/s]
Evaluating...:  99%|█████████▉| 140/141 [00:18<00:00,  7.73it/s]
Evaluating...: 100%|██████████| 141/141 [00:18<00:00,  7.70it/s]
Evaluating...: 100%|██████████| 141/141 [00:18<00:00,  7.60it/s]
Perplexity: 6.36095666885376
Running with alpha=0.75
Token indices sequence length is longer than the specified maximum sequence length for this model (289077 > 131072). Running this sequence through the model will result in indexing errors
N:M Sparsity: 0: 0

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.43s/it]
Loading checkpoint shards:  50%|█████     | 2/4 [00:06<00:06,  3.38s/it]
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:09<00:03,  3.28s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:10<00:00,  2.30s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:10<00:00,  2.68s/it]
/gemini/code/NMSparsity/smoothquant/smoothquant/ppl_eval.py:87: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  act_scales = torch.load(act_scales_path)
smooth...
quantize...

Evaluating...:   0%|          | 0/141 [00:00<?, ?it/s]
Evaluating...:   1%|          | 1/141 [00:00<00:56,  2.48it/s]
Evaluating...:   2%|▏         | 3/141 [00:00<00:25,  5.40it/s]
Evaluating...:   3%|▎         | 4/141 [00:00<00:22,  6.02it/s]
Evaluating...:   4%|▎         | 5/141 [00:00<00:20,  6.51it/s]
Evaluating...:   4%|▍         | 6/141 [00:01<00:19,  6.85it/s]
Evaluating...:   5%|▍         | 7/141 [00:01<00:18,  7.11it/s]
Evaluating...:   6%|▌         | 8/141 [00:01<00:18,  7.27it/s]
Evaluating...:   6%|▋         | 9/141 [00:01<00:17,  7.41it/s]
Evaluating...:   7%|▋         | 10/141 [00:01<00:17,  7.51it/s]
Evaluating...:   8%|▊         | 11/141 [00:01<00:17,  7.57it/s]
Evaluating...:   9%|▊         | 12/141 [00:01<00:16,  7.62it/s]
Evaluating...:   9%|▉         | 13/141 [00:01<00:16,  7.67it/s]
Evaluating...:  10%|▉         | 14/141 [00:02<00:16,  7.69it/s]
Evaluating...:  11%|█         | 15/141 [00:02<00:16,  7.70it/s]
Evaluating...:  11%|█▏        | 16/141 [00:02<00:16,  7.69it/s]
Evaluating...:  12%|█▏        | 17/141 [00:02<00:16,  7.71it/s]
Evaluating...:  13%|█▎        | 18/141 [00:02<00:15,  7.72it/s]
Evaluating...:  13%|█▎        | 19/141 [00:02<00:15,  7.73it/s]
Evaluating...:  14%|█▍        | 20/141 [00:02<00:16,  7.39it/s]
Evaluating...:  15%|█▍        | 21/141 [00:02<00:15,  7.67it/s]
Evaluating...:  16%|█▌        | 22/141 [00:03<00:15,  7.69it/s]
Evaluating...:  16%|█▋        | 23/141 [00:03<00:15,  7.70it/s]
Evaluating...:  17%|█▋        | 24/141 [00:03<00:15,  7.68it/s]
Evaluating...:  18%|█▊        | 25/141 [00:03<00:15,  7.69it/s]
Evaluating...:  18%|█▊        | 26/141 [00:03<00:14,  7.69it/s]
Evaluating...:  19%|█▉        | 27/141 [00:03<00:14,  7.68it/s]
Evaluating...:  20%|█▉        | 28/141 [00:03<00:14,  7.72it/s]
Evaluating...:  21%|██        | 29/141 [00:03<00:14,  7.70it/s]
Evaluating...:  21%|██▏       | 30/141 [00:04<00:14,  7.71it/s]
Evaluating...:  22%|██▏       | 31/141 [00:04<00:14,  7.70it/s]
Evaluating...:  23%|██▎       | 32/141 [00:04<00:14,  7.71it/s]
Evaluating...:  23%|██▎       | 33/141 [00:04<00:14,  7.71it/s]
Evaluating...:  24%|██▍       | 34/141 [00:04<00:13,  7.72it/s]
Evaluating...:  25%|██▍       | 35/141 [00:04<00:13,  7.74it/s]
Evaluating...:  26%|██▌       | 36/141 [00:04<00:13,  7.65it/s]
Evaluating...:  26%|██▌       | 37/141 [00:05<00:13,  7.72it/s]
Evaluating...:  27%|██▋       | 38/141 [00:05<00:13,  7.73it/s]
Evaluating...:  28%|██▊       | 39/141 [00:05<00:13,  7.73it/s]
Evaluating...:  28%|██▊       | 40/141 [00:05<00:13,  7.72it/s]
Evaluating...:  29%|██▉       | 41/141 [00:05<00:12,  7.72it/s]
Evaluating...:  30%|██▉       | 42/141 [00:05<00:12,  7.72it/s]
Evaluating...:  30%|███       | 43/141 [00:05<00:12,  7.72it/s]
Evaluating...:  31%|███       | 44/141 [00:05<00:12,  7.72it/s]
Evaluating...:  32%|███▏      | 45/141 [00:06<00:12,  7.74it/s]
Evaluating...:  33%|███▎      | 46/141 [00:06<00:12,  7.72it/s]
Evaluating...:  33%|███▎      | 47/141 [00:06<00:12,  7.73it/s]
Evaluating...:  34%|███▍      | 48/141 [00:06<00:12,  7.73it/s]
Evaluating...:  35%|███▍      | 49/141 [00:06<00:11,  7.72it/s]
Evaluating...:  35%|███▌      | 50/141 [00:06<00:11,  7.72it/s]
Evaluating...:  36%|███▌      | 51/141 [00:06<00:11,  7.72it/s]
Evaluating...:  37%|███▋      | 52/141 [00:06<00:11,  7.75it/s]
Evaluating...:  38%|███▊      | 53/141 [00:07<00:11,  7.72it/s]
Evaluating...:  38%|███▊      | 54/141 [00:07<00:11,  7.74it/s]
Evaluating...:  39%|███▉      | 55/141 [00:07<00:11,  7.76it/s]
Evaluating...:  40%|███▉      | 56/141 [00:07<00:10,  7.76it/s]
Evaluating...:  40%|████      | 57/141 [00:07<00:10,  7.74it/s]
Evaluating...:  41%|████      | 58/141 [00:07<00:10,  7.74it/s]
Evaluating...:  42%|████▏     | 59/141 [00:07<00:10,  7.72it/s]
Evaluating...:  43%|████▎     | 60/141 [00:08<00:10,  7.74it/s]
Evaluating...:  43%|████▎     | 61/141 [00:08<00:10,  7.74it/s]
Evaluating...:  44%|████▍     | 62/141 [00:08<00:10,  7.72it/s]
Evaluating...:  45%|████▍     | 63/141 [00:08<00:10,  7.71it/s]
Evaluating...:  45%|████▌     | 64/141 [00:08<00:09,  7.72it/s]
Evaluating...:  46%|████▌     | 65/141 [00:08<00:09,  7.72it/s]
Evaluating...:  47%|████▋     | 66/141 [00:08<00:09,  7.71it/s]
Evaluating...:  48%|████▊     | 67/141 [00:08<00:09,  7.74it/s]
Evaluating...:  48%|████▊     | 68/141 [00:09<00:09,  7.74it/s]
Evaluating...:  49%|████▉     | 69/141 [00:09<00:09,  7.72it/s]
Evaluating...:  50%|████▉     | 70/141 [00:09<00:09,  7.72it/s]
Evaluating...:  50%|█████     | 71/141 [00:09<00:09,  7.71it/s]
Evaluating...:  51%|█████     | 72/141 [00:09<00:08,  7.72it/s]
Evaluating...:  52%|█████▏    | 73/141 [00:09<00:08,  7.73it/s]
Evaluating...:  52%|█████▏    | 74/141 [00:09<00:08,  7.74it/s]
Evaluating...:  53%|█████▎    | 75/141 [00:09<00:08,  7.74it/s]
Evaluating...:  54%|█████▍    | 76/141 [00:10<00:08,  7.73it/s]
Evaluating...:  55%|█████▍    | 77/141 [00:10<00:08,  7.72it/s]
Evaluating...:  55%|█████▌    | 78/141 [00:10<00:08,  7.70it/s]
Evaluating...:  56%|█████▌    | 79/141 [00:10<00:08,  7.71it/s]
Evaluating...:  57%|█████▋    | 80/141 [00:10<00:07,  7.71it/s]
Evaluating...:  57%|█████▋    | 81/141 [00:10<00:07,  7.71it/s]
Evaluating...:  58%|█████▊    | 82/141 [00:10<00:07,  7.73it/s]
Evaluating...:  59%|█████▉    | 83/141 [00:10<00:07,  7.72it/s]
Evaluating...:  60%|█████▉    | 84/141 [00:11<00:07,  7.71it/s]
Evaluating...:  60%|██████    | 85/141 [00:11<00:07,  7.72it/s]
Evaluating...:  61%|██████    | 86/141 [00:11<00:07,  7.72it/s]
Evaluating...:  62%|██████▏   | 87/141 [00:11<00:06,  7.72it/s]
Evaluating...:  62%|██████▏   | 88/141 [00:11<00:06,  7.71it/s]
Evaluating...:  63%|██████▎   | 89/141 [00:11<00:06,  7.75it/s]
Evaluating...:  64%|██████▍   | 90/141 [00:11<00:06,  7.73it/s]
Evaluating...:  65%|██████▍   | 91/141 [00:12<00:06,  7.74it/s]
Evaluating...:  65%|██████▌   | 92/141 [00:12<00:06,  7.73it/s]
Evaluating...:  66%|██████▌   | 93/141 [00:12<00:06,  7.72it/s]
Evaluating...:  67%|██████▋   | 94/141 [00:12<00:06,  7.71it/s]
Evaluating...:  67%|██████▋   | 95/141 [00:12<00:05,  7.70it/s]
Evaluating...:  68%|██████▊   | 96/141 [00:12<00:05,  7.73it/s]
Evaluating...:  69%|██████▉   | 97/141 [00:12<00:05,  7.65it/s]
Evaluating...:  70%|██████▉   | 98/141 [00:12<00:05,  7.73it/s]
Evaluating...:  70%|███████   | 99/141 [00:13<00:05,  7.74it/s]
Evaluating...:  71%|███████   | 100/141 [00:13<00:05,  7.72it/s]
Evaluating...:  72%|███████▏  | 101/141 [00:13<00:05,  7.72it/s]
Evaluating...:  72%|███████▏  | 102/141 [00:13<00:05,  7.73it/s]
Evaluating...:  73%|███████▎  | 103/141 [00:13<00:04,  7.74it/s]
Evaluating...:  74%|███████▍  | 104/141 [00:13<00:04,  7.72it/s]
Evaluating...:  74%|███████▍  | 105/141 [00:13<00:04,  7.73it/s]
Evaluating...:  75%|███████▌  | 106/141 [00:13<00:04,  7.73it/s]
Evaluating...:  76%|███████▌  | 107/141 [00:14<00:04,  7.71it/s]
Evaluating...:  77%|███████▋  | 108/141 [00:14<00:04,  7.71it/s]
Evaluating...:  77%|███████▋  | 109/141 [00:14<00:04,  7.69it/s]
Evaluating...:  78%|███████▊  | 110/141 [00:14<00:04,  7.72it/s]
Evaluating...:  79%|███████▊  | 111/141 [00:14<00:03,  7.73it/s]
Evaluating...:  79%|███████▉  | 112/141 [00:14<00:03,  7.71it/s]
Evaluating...:  80%|████████  | 113/141 [00:14<00:03,  7.70it/s]
Evaluating...:  81%|████████  | 114/141 [00:15<00:03,  7.70it/s]
Evaluating...:  82%|████████▏ | 115/141 [00:15<00:03,  7.69it/s]
Evaluating...:  82%|████████▏ | 116/141 [00:15<00:03,  7.72it/s]
Evaluating...:  83%|████████▎ | 117/141 [00:15<00:03,  7.70it/s]
Evaluating...:  84%|████████▎ | 118/141 [00:15<00:02,  7.72it/s]
Evaluating...:  84%|████████▍ | 119/141 [00:15<00:02,  7.70it/s]
Evaluating...:  85%|████████▌ | 120/141 [00:15<00:02,  7.71it/s]
Evaluating...:  86%|████████▌ | 121/141 [00:15<00:02,  7.69it/s]
Evaluating...:  87%|████████▋ | 122/141 [00:16<00:02,  7.70it/s]
Evaluating...:  87%|████████▋ | 123/141 [00:16<00:02,  7.69it/s]
Evaluating...:  88%|████████▊ | 124/141 [00:16<00:02,  7.68it/s]
Evaluating...:  89%|████████▊ | 125/141 [00:16<00:02,  7.73it/s]
Evaluating...:  89%|████████▉ | 126/141 [00:16<00:01,  7.70it/s]
Evaluating...:  90%|█████████ | 127/141 [00:16<00:01,  7.70it/s]
Evaluating...:  91%|█████████ | 128/141 [00:16<00:01,  7.71it/s]
Evaluating...:  91%|█████████▏| 129/141 [00:16<00:01,  7.70it/s]
Evaluating...:  92%|█████████▏| 130/141 [00:17<00:01,  7.68it/s]
Evaluating...:  93%|█████████▎| 131/141 [00:17<00:01,  7.69it/s]
Evaluating...:  94%|█████████▎| 132/141 [00:17<00:01,  7.72it/s]
Evaluating...:  94%|█████████▍| 133/141 [00:17<00:01,  7.73it/s]
Evaluating...:  95%|█████████▌| 134/141 [00:17<00:00,  7.73it/s]
Evaluating...:  96%|█████████▌| 135/141 [00:17<00:00,  7.74it/s]
Evaluating...:  96%|█████████▋| 136/141 [00:17<00:00,  7.74it/s]
Evaluating...:  97%|█████████▋| 137/141 [00:17<00:00,  7.72it/s]
Evaluating...:  98%|█████████▊| 138/141 [00:18<00:00,  7.72it/s]
Evaluating...:  99%|█████████▊| 139/141 [00:18<00:00,  7.71it/s]
Evaluating...:  99%|█████████▉| 140/141 [00:18<00:00,  7.74it/s]
Evaluating...: 100%|██████████| 141/141 [00:18<00:00,  7.74it/s]
Evaluating...: 100%|██████████| 141/141 [00:18<00:00,  7.62it/s]
Perplexity: 6.351933002471924
Running with alpha=0.85
Token indices sequence length is longer than the specified maximum sequence length for this model (289077 > 131072). Running this sequence through the model will result in indexing errors
N:M Sparsity: 0: 0

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:10,  3.47s/it]
Loading checkpoint shards:  50%|█████     | 2/4 [00:07<00:07,  3.72s/it]
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:10<00:03,  3.49s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:11<00:00,  2.45s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:11<00:00,  2.86s/it]
/gemini/code/NMSparsity/smoothquant/smoothquant/ppl_eval.py:87: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  act_scales = torch.load(act_scales_path)
smooth...
quantize...

Evaluating...:   0%|          | 0/141 [00:00<?, ?it/s]
Evaluating...:   1%|          | 1/141 [00:00<00:51,  2.70it/s]
Evaluating...:   2%|▏         | 3/141 [00:00<00:24,  5.65it/s]
Evaluating...:   3%|▎         | 4/141 [00:00<00:21,  6.23it/s]
Evaluating...:   4%|▎         | 5/141 [00:00<00:20,  6.66it/s]
Evaluating...:   4%|▍         | 6/141 [00:00<00:19,  6.96it/s]
Evaluating...:   5%|▍         | 7/141 [00:01<00:18,  7.18it/s]
Evaluating...:   6%|▌         | 8/141 [00:01<00:18,  7.33it/s]
Evaluating...:   6%|▋         | 9/141 [00:01<00:17,  7.43it/s]
Evaluating...:   7%|▋         | 10/141 [00:01<00:17,  7.51it/s]
Evaluating...:   8%|▊         | 11/141 [00:01<00:17,  7.58it/s]
Evaluating...:   9%|▊         | 12/141 [00:01<00:16,  7.64it/s]
Evaluating...:   9%|▉         | 13/141 [00:01<00:16,  7.66it/s]
Evaluating...:  10%|▉         | 14/141 [00:02<00:16,  7.68it/s]
Evaluating...:  11%|█         | 15/141 [00:02<00:16,  7.67it/s]
Evaluating...:  11%|█▏        | 16/141 [00:02<00:16,  7.68it/s]
Evaluating...:  12%|█▏        | 17/141 [00:02<00:16,  7.69it/s]
Evaluating...:  13%|█▎        | 18/141 [00:02<00:15,  7.69it/s]
Evaluating...:  13%|█▎        | 19/141 [00:02<00:15,  7.73it/s]
Evaluating...:  14%|█▍        | 20/141 [00:02<00:15,  7.74it/s]
Evaluating...:  15%|█▍        | 21/141 [00:02<00:15,  7.73it/s]
Evaluating...:  16%|█▌        | 22/141 [00:03<00:15,  7.72it/s]
Evaluating...:  16%|█▋        | 23/141 [00:03<00:15,  7.71it/s]
Evaluating...:  17%|█▋        | 24/141 [00:03<00:15,  7.70it/s]
Evaluating...:  18%|█▊        | 25/141 [00:03<00:15,  7.71it/s]
Evaluating...:  18%|█▊        | 26/141 [00:03<00:14,  7.74it/s]
Evaluating...:  19%|█▉        | 27/141 [00:03<00:14,  7.73it/s]
Evaluating...:  20%|█▉        | 28/141 [00:03<00:14,  7.73it/s]
Evaluating...:  21%|██        | 29/141 [00:03<00:14,  7.71it/s]
Evaluating...:  21%|██▏       | 30/141 [00:04<00:14,  7.71it/s]
Evaluating...:  22%|██▏       | 31/141 [00:04<00:14,  7.71it/s]
Evaluating...:  23%|██▎       | 32/141 [00:04<00:14,  7.70it/s]
Evaluating...:  23%|██▎       | 33/141 [00:04<00:13,  7.72it/s]
Evaluating...:  24%|██▍       | 34/141 [00:04<00:13,  7.72it/s]
Evaluating...:  25%|██▍       | 35/141 [00:04<00:13,  7.72it/s]
Evaluating...:  26%|██▌       | 36/141 [00:04<00:13,  7.72it/s]
Evaluating...:  26%|██▌       | 37/141 [00:04<00:13,  7.70it/s]
Evaluating...:  27%|██▋       | 38/141 [00:05<00:13,  7.70it/s]
Evaluating...:  28%|██▊       | 39/141 [00:05<00:13,  7.69it/s]
Evaluating...:  28%|██▊       | 40/141 [00:05<00:13,  7.71it/s]
Evaluating...:  29%|██▉       | 41/141 [00:05<00:12,  7.73it/s]
Evaluating...:  30%|██▉       | 42/141 [00:05<00:12,  7.72it/s]
Evaluating...:  30%|███       | 43/141 [00:05<00:12,  7.70it/s]
Evaluating...:  31%|███       | 44/141 [00:05<00:12,  7.68it/s]
Evaluating...:  32%|███▏      | 45/141 [00:06<00:12,  7.69it/s]
Evaluating...:  33%|███▎      | 46/141 [00:06<00:12,  7.70it/s]
Evaluating...:  33%|███▎      | 47/141 [00:06<00:12,  7.71it/s]
Evaluating...:  34%|███▍      | 48/141 [00:06<00:12,  7.74it/s]
Evaluating...:  35%|███▍      | 49/141 [00:06<00:11,  7.73it/s]
Evaluating...:  35%|███▌      | 50/141 [00:06<00:11,  7.73it/s]
Evaluating...:  36%|███▌      | 51/141 [00:06<00:11,  7.71it/s]
Evaluating...:  37%|███▋      | 52/141 [00:06<00:11,  7.71it/s]
Evaluating...:  38%|███▊      | 53/141 [00:07<00:11,  7.69it/s]
Evaluating...:  38%|███▊      | 54/141 [00:07<00:11,  7.70it/s]
Evaluating...:  39%|███▉      | 55/141 [00:07<00:11,  7.73it/s]
Evaluating...:  40%|███▉      | 56/141 [00:07<00:11,  7.72it/s]
Evaluating...:  40%|████      | 57/141 [00:07<00:10,  7.71it/s]
Evaluating...:  41%|████      | 58/141 [00:07<00:10,  7.70it/s]
Evaluating...:  42%|████▏     | 59/141 [00:07<00:10,  7.71it/s]
Evaluating...:  43%|████▎     | 60/141 [00:07<00:10,  7.71it/s]
Evaluating...:  43%|████▎     | 61/141 [00:08<00:10,  7.71it/s]
Evaluating...:  44%|████▍     | 62/141 [00:08<00:10,  7.74it/s]
Evaluating...:  45%|████▍     | 63/141 [00:08<00:10,  7.74it/s]
Evaluating...:  45%|████▌     | 64/141 [00:08<00:09,  7.71it/s]
Evaluating...:  46%|████▌     | 65/141 [00:08<00:09,  7.71it/s]
Evaluating...:  47%|████▋     | 66/141 [00:08<00:09,  7.70it/s]
Evaluating...:  48%|████▊     | 67/141 [00:08<00:09,  7.71it/s]
Evaluating...:  48%|████▊     | 68/141 [00:09<00:09,  7.70it/s]
Evaluating...:  49%|████▉     | 69/141 [00:09<00:09,  7.69it/s]
Evaluating...:  50%|████▉     | 70/141 [00:09<00:09,  7.74it/s]
Evaluating...:  50%|█████     | 71/141 [00:09<00:09,  7.73it/s]
Evaluating...:  51%|█████     | 72/141 [00:09<00:08,  7.71it/s]
Evaluating...:  52%|█████▏    | 73/141 [00:09<00:08,  7.71it/s]
Evaluating...:  52%|█████▏    | 74/141 [00:09<00:08,  7.70it/s]
Evaluating...:  53%|█████▎    | 75/141 [00:09<00:08,  7.70it/s]
Evaluating...:  54%|█████▍    | 76/141 [00:10<00:08,  7.71it/s]
Evaluating...:  55%|█████▍    | 77/141 [00:10<00:08,  7.74it/s]
Evaluating...:  55%|█████▌    | 78/141 [00:10<00:08,  7.72it/s]
Evaluating...:  56%|█████▌    | 79/141 [00:10<00:08,  7.70it/s]
Evaluating...:  57%|█████▋    | 80/141 [00:10<00:07,  7.70it/s]
Evaluating...:  57%|█████▋    | 81/141 [00:10<00:07,  7.68it/s]
Evaluating...:  58%|█████▊    | 82/141 [00:10<00:07,  7.70it/s]
Evaluating...:  59%|█████▉    | 83/141 [00:10<00:07,  7.69it/s]
Evaluating...:  60%|█████▉    | 84/141 [00:11<00:07,  7.73it/s]
Evaluating...:  60%|██████    | 85/141 [00:11<00:07,  7.72it/s]
Evaluating...:  61%|██████    | 86/141 [00:11<00:07,  7.71it/s]
Evaluating...:  62%|██████▏   | 87/141 [00:11<00:07,  7.70it/s]
Evaluating...:  62%|██████▏   | 88/141 [00:11<00:06,  7.69it/s]
Evaluating...:  63%|██████▎   | 89/141 [00:11<00:06,  7.70it/s]
Evaluating...:  64%|██████▍   | 90/141 [00:11<00:06,  7.69it/s]
Evaluating...:  65%|██████▍   | 91/141 [00:11<00:06,  7.73it/s]
Evaluating...:  65%|██████▌   | 92/141 [00:12<00:06,  7.72it/s]
Evaluating...:  66%|██████▌   | 93/141 [00:12<00:06,  7.70it/s]
Evaluating...:  67%|██████▋   | 94/141 [00:12<00:06,  7.69it/s]
Evaluating...:  67%|██████▋   | 95/141 [00:12<00:05,  7.68it/s]
Evaluating...:  68%|██████▊   | 96/141 [00:12<00:05,  7.69it/s]
Evaluating...:  69%|██████▉   | 97/141 [00:12<00:05,  7.68it/s]
Evaluating...:  70%|██████▉   | 98/141 [00:12<00:05,  7.72it/s]
Evaluating...:  70%|███████   | 99/141 [00:13<00:05,  7.72it/s]
Evaluating...:  71%|███████   | 100/141 [00:13<00:05,  7.71it/s]
Evaluating...:  72%|███████▏  | 101/141 [00:13<00:05,  7.71it/s]
Evaluating...:  72%|███████▏  | 102/141 [00:13<00:05,  7.70it/s]
Evaluating...:  73%|███████▎  | 103/141 [00:13<00:04,  7.68it/s]
Evaluating...:  74%|███████▍  | 104/141 [00:13<00:04,  7.70it/s]
Evaluating...:  74%|███████▍  | 105/141 [00:13<00:04,  7.73it/s]
Evaluating...:  75%|███████▌  | 106/141 [00:13<00:04,  7.72it/s]
Evaluating...:  76%|███████▌  | 107/141 [00:14<00:04,  7.71it/s]
Evaluating...:  77%|███████▋  | 108/141 [00:14<00:04,  7.70it/s]
Evaluating...:  77%|███████▋  | 109/141 [00:14<00:04,  7.68it/s]
Evaluating...:  78%|███████▊  | 110/141 [00:14<00:04,  7.68it/s]
Evaluating...:  79%|███████▊  | 111/141 [00:14<00:03,  7.68it/s]
Evaluating...:  79%|███████▉  | 112/141 [00:14<00:03,  7.71it/s]
Evaluating...:  80%|████████  | 113/141 [00:14<00:03,  7.71it/s]
Evaluating...:  81%|████████  | 114/141 [00:14<00:03,  7.71it/s]
Evaluating...:  82%|████████▏ | 115/141 [00:15<00:03,  7.70it/s]
Evaluating...:  82%|████████▏ | 116/141 [00:15<00:03,  7.69it/s]
Evaluating...:  83%|████████▎ | 117/141 [00:15<00:03,  7.69it/s]
Evaluating...:  84%|████████▎ | 118/141 [00:15<00:02,  7.69it/s]
Evaluating...:  84%|████████▍ | 119/141 [00:15<00:02,  7.70it/s]
Evaluating...:  85%|████████▌ | 120/141 [00:15<00:02,  7.72it/s]
Evaluating...:  86%|████████▌ | 121/141 [00:15<00:02,  7.72it/s]
Evaluating...:  87%|████████▋ | 122/141 [00:16<00:02,  7.70it/s]
Evaluating...:  87%|████████▋ | 123/141 [00:16<00:02,  7.70it/s]
Evaluating...:  88%|████████▊ | 124/141 [00:16<00:02,  7.70it/s]
Evaluating...:  89%|████████▊ | 125/141 [00:16<00:02,  7.69it/s]
Evaluating...:  89%|████████▉ | 126/141 [00:16<00:01,  7.70it/s]
Evaluating...:  90%|█████████ | 127/141 [00:16<00:01,  7.73it/s]
Evaluating...:  91%|█████████ | 128/141 [00:16<00:01,  7.72it/s]
Evaluating...:  91%|█████████▏| 129/141 [00:16<00:01,  7.70it/s]
Evaluating...:  92%|█████████▏| 130/141 [00:17<00:01,  7.69it/s]
Evaluating...:  93%|█████████▎| 131/141 [00:17<00:01,  7.68it/s]
Evaluating...:  94%|█████████▎| 132/141 [00:17<00:01,  7.69it/s]
Evaluating...:  94%|█████████▍| 133/141 [00:17<00:01,  7.68it/s]
Evaluating...:  95%|█████████▌| 134/141 [00:17<00:00,  7.70it/s]
Evaluating...:  96%|█████████▌| 135/141 [00:17<00:00,  7.69it/s]
Evaluating...:  96%|█████████▋| 136/141 [00:17<00:00,  7.69it/s]
Evaluating...:  97%|█████████▋| 137/141 [00:17<00:00,  7.69it/s]
Evaluating...:  98%|█████████▊| 138/141 [00:18<00:00,  7.69it/s]
Evaluating...:  99%|█████████▊| 139/141 [00:18<00:00,  7.69it/s]
Evaluating...:  99%|█████████▉| 140/141 [00:18<00:00,  7.68it/s]
Evaluating...: 100%|██████████| 141/141 [00:18<00:00,  7.72it/s]
Evaluating...: 100%|██████████| 141/141 [00:18<00:00,  7.62it/s]
Perplexity: 6.353745460510254
Running with alpha=0.99
Token indices sequence length is longer than the specified maximum sequence length for this model (289077 > 131072). Running this sequence through the model will result in indexing errors
N:M Sparsity: 0: 0

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|██▌       | 1/4 [00:03<00:09,  3.29s/it]
Loading checkpoint shards:  50%|█████     | 2/4 [00:06<00:06,  3.27s/it]
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:09<00:03,  3.21s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:10<00:00,  2.24s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:10<00:00,  2.61s/it]
/gemini/code/NMSparsity/smoothquant/smoothquant/ppl_eval.py:87: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  act_scales = torch.load(act_scales_path)
smooth...
quantize...

Evaluating...:   0%|          | 0/141 [00:00<?, ?it/s]
Evaluating...:   1%|          | 1/141 [00:00<00:55,  2.54it/s]
Evaluating...:   2%|▏         | 3/141 [00:00<00:25,  5.47it/s]
Evaluating...:   3%|▎         | 4/141 [00:00<00:22,  6.09it/s]
Evaluating...:   4%|▎         | 5/141 [00:00<00:20,  6.54it/s]
Evaluating...:   4%|▍         | 6/141 [00:01<00:19,  6.87it/s]
Evaluating...:   5%|▍         | 7/141 [00:01<00:18,  7.10it/s]
Evaluating...:   6%|▌         | 8/141 [00:01<00:18,  7.28it/s]
Evaluating...:   6%|▋         | 9/141 [00:01<00:17,  7.40it/s]
Evaluating...:   7%|▋         | 10/141 [00:01<00:17,  7.49it/s]
Evaluating...:   8%|▊         | 11/141 [00:01<00:17,  7.56it/s]
Evaluating...:   9%|▊         | 12/141 [00:01<00:16,  7.61it/s]
Evaluating...:   9%|▉         | 13/141 [00:01<00:16,  7.66it/s]
Evaluating...:  10%|▉         | 14/141 [00:02<00:16,  7.67it/s]
Evaluating...:  11%|█         | 15/141 [00:02<00:16,  7.67it/s]
Evaluating...:  11%|█▏        | 16/141 [00:02<00:16,  7.68it/s]
Evaluating...:  12%|█▏        | 17/141 [00:02<00:16,  7.67it/s]
Evaluating...:  13%|█▎        | 18/141 [00:02<00:15,  7.69it/s]
Evaluating...:  13%|█▎        | 19/141 [00:02<00:15,  7.72it/s]
Evaluating...:  14%|█▍        | 20/141 [00:02<00:15,  7.73it/s]
Evaluating...:  15%|█▍        | 21/141 [00:02<00:15,  7.71it/s]
Evaluating...:  16%|█▌        | 22/141 [00:03<00:15,  7.71it/s]
Evaluating...:  16%|█▋        | 23/141 [00:03<00:15,  7.72it/s]
Evaluating...:  17%|█▋        | 24/141 [00:03<00:15,  7.70it/s]
Evaluating...:  18%|█▊        | 25/141 [00:03<00:15,  7.70it/s]
Evaluating...:  18%|█▊        | 26/141 [00:03<00:14,  7.73it/s]
Evaluating...:  19%|█▉        | 27/141 [00:03<00:14,  7.72it/s]
Evaluating...:  20%|█▉        | 28/141 [00:03<00:14,  7.70it/s]
Evaluating...:  21%|██        | 29/141 [00:03<00:14,  7.69it/s]
Evaluating...:  21%|██▏       | 30/141 [00:04<00:14,  7.68it/s]
Evaluating...:  22%|██▏       | 31/141 [00:04<00:14,  7.69it/s]
Evaluating...:  23%|██▎       | 32/141 [00:04<00:14,  7.70it/s]
Evaluating...:  23%|██▎       | 33/141 [00:04<00:13,  7.73it/s]
Evaluating...:  24%|██▍       | 34/141 [00:04<00:13,  7.72it/s]
Evaluating...:  25%|██▍       | 35/141 [00:04<00:13,  7.74it/s]
Evaluating...:  26%|██▌       | 36/141 [00:04<00:13,  7.73it/s]
Evaluating...:  26%|██▌       | 37/141 [00:05<00:13,  7.71it/s]
Evaluating...:  27%|██▋       | 38/141 [00:05<00:13,  7.70it/s]
Evaluating...:  28%|██▊       | 39/141 [00:05<00:13,  7.72it/s]
Evaluating...:  28%|██▊       | 40/141 [00:05<00:13,  7.71it/s]
Evaluating...:  29%|██▉       | 41/141 [00:05<00:12,  7.73it/s]
Evaluating...:  30%|██▉       | 42/141 [00:05<00:12,  7.72it/s]
Evaluating...:  30%|███       | 43/141 [00:05<00:12,  7.71it/s]
Evaluating...:  31%|███       | 44/141 [00:05<00:12,  7.69it/s]
Evaluating...:  32%|███▏      | 45/141 [00:06<00:12,  7.69it/s]
Evaluating...:  33%|███▎      | 46/141 [00:06<00:12,  7.67it/s]
Evaluating...:  33%|███▎      | 47/141 [00:06<00:12,  7.69it/s]
Evaluating...:  34%|███▍      | 48/141 [00:06<00:12,  7.71it/s]
Evaluating...:  35%|███▍      | 49/141 [00:06<00:11,  7.71it/s]
Evaluating...:  35%|███▌      | 50/141 [00:06<00:11,  7.70it/s]
Evaluating...:  36%|███▌      | 51/141 [00:06<00:11,  7.69it/s]
Evaluating...:  37%|███▋      | 52/141 [00:06<00:11,  7.68it/s]
Evaluating...:  38%|███▊      | 53/141 [00:07<00:11,  7.68it/s]
Evaluating...:  38%|███▊      | 54/141 [00:07<00:11,  7.67it/s]
Evaluating...:  39%|███▉      | 55/141 [00:07<00:11,  7.71it/s]
Evaluating...:  40%|███▉      | 56/141 [00:07<00:11,  7.71it/s]
Evaluating...:  40%|████      | 57/141 [00:07<00:10,  7.71it/s]
Evaluating...:  41%|████      | 58/141 [00:07<00:10,  7.72it/s]
Evaluating...:  42%|████▏     | 59/141 [00:07<00:10,  7.71it/s]
Evaluating...:  43%|████▎     | 60/141 [00:08<00:10,  7.71it/s]
Evaluating...:  43%|████▎     | 61/141 [00:08<00:10,  7.71it/s]
Evaluating...:  44%|████▍     | 62/141 [00:08<00:10,  7.71it/s]
Evaluating...:  45%|████▍     | 63/141 [00:08<00:10,  7.72it/s]
Evaluating...:  45%|████▌     | 64/141 [00:08<00:09,  7.71it/s]
Evaluating...:  46%|████▌     | 65/141 [00:08<00:09,  7.70it/s]
Evaluating...:  47%|████▋     | 66/141 [00:08<00:09,  7.70it/s]
Evaluating...:  48%|████▊     | 67/141 [00:08<00:09,  7.69it/s]
Evaluating...:  48%|████▊     | 68/141 [00:09<00:09,  7.69it/s]
Evaluating...:  49%|████▉     | 69/141 [00:09<00:09,  7.70it/s]
Evaluating...:  50%|████▉     | 70/141 [00:09<00:09,  7.72it/s]
Evaluating...:  50%|█████     | 71/141 [00:09<00:09,  7.71it/s]
Evaluating...:  51%|█████     | 72/141 [00:09<00:08,  7.70it/s]
Evaluating...:  52%|█████▏    | 73/141 [00:09<00:08,  7.70it/s]
Evaluating...:  52%|█████▏    | 74/141 [00:09<00:08,  7.69it/s]
Evaluating...:  53%|█████▎    | 75/141 [00:09<00:08,  7.69it/s]
Evaluating...:  54%|█████▍    | 76/141 [00:10<00:08,  7.68it/s]
Evaluating...:  55%|█████▍    | 77/141 [00:10<00:08,  7.71it/s]
Evaluating...:  55%|█████▌    | 78/141 [00:10<00:08,  7.71it/s]
Evaluating...:  56%|█████▌    | 79/141 [00:10<00:08,  7.70it/s]
Evaluating...:  57%|█████▋    | 80/141 [00:10<00:07,  7.70it/s]
Evaluating...:  57%|█████▋    | 81/141 [00:10<00:07,  7.68it/s]
Evaluating...:  58%|█████▊    | 82/141 [00:10<00:07,  7.69it/s]
Evaluating...:  59%|█████▉    | 83/141 [00:10<00:07,  7.67it/s]
Evaluating...:  60%|█████▉    | 84/141 [00:11<00:07,  7.71it/s]
Evaluating...:  60%|██████    | 85/141 [00:11<00:07,  7.70it/s]
Evaluating...:  61%|██████    | 86/141 [00:11<00:07,  7.71it/s]
Evaluating...:  62%|██████▏   | 87/141 [00:11<00:07,  7.70it/s]
Evaluating...:  62%|██████▏   | 88/141 [00:11<00:06,  7.68it/s]
Evaluating...:  63%|██████▎   | 89/141 [00:11<00:06,  7.67it/s]
Evaluating...:  64%|██████▍   | 90/141 [00:11<00:06,  7.67it/s]
Evaluating...:  65%|██████▍   | 91/141 [00:12<00:06,  7.71it/s]
Evaluating...:  65%|██████▌   | 92/141 [00:12<00:06,  7.70it/s]
Evaluating...:  66%|██████▌   | 93/141 [00:12<00:06,  7.71it/s]
Evaluating...:  67%|██████▋   | 94/141 [00:12<00:06,  7.69it/s]
Evaluating...:  67%|██████▋   | 95/141 [00:12<00:05,  7.69it/s]
Evaluating...:  68%|██████▊   | 96/141 [00:12<00:05,  7.68it/s]
Evaluating...:  69%|██████▉   | 97/141 [00:12<00:05,  7.69it/s]
Evaluating...:  70%|██████▉   | 98/141 [00:12<00:05,  7.70it/s]
Evaluating...:  70%|███████   | 99/141 [00:13<00:05,  7.69it/s]
Evaluating...:  71%|███████   | 100/141 [00:13<00:05,  7.70it/s]
Evaluating...:  72%|███████▏  | 101/141 [00:13<00:05,  7.70it/s]
Evaluating...:  72%|███████▏  | 102/141 [00:13<00:05,  7.69it/s]
Evaluating...:  73%|███████▎  | 103/141 [00:13<00:04,  7.70it/s]
Evaluating...:  74%|███████▍  | 104/141 [00:13<00:04,  7.69it/s]
Evaluating...:  74%|███████▍  | 105/141 [00:13<00:04,  7.69it/s]
Evaluating...:  75%|███████▌  | 106/141 [00:13<00:04,  7.70it/s]
Evaluating...:  76%|███████▌  | 107/141 [00:14<00:04,  7.65it/s]
Evaluating...:  77%|███████▋  | 108/141 [00:14<00:04,  7.68it/s]
Evaluating...:  77%|███████▋  | 109/141 [00:14<00:04,  7.69it/s]
Evaluating...:  78%|███████▊  | 110/141 [00:14<00:04,  7.69it/s]
Evaluating...:  79%|███████▊  | 111/141 [00:14<00:03,  7.70it/s]
Evaluating...:  79%|███████▉  | 112/141 [00:14<00:03,  7.69it/s]
Evaluating...:  80%|████████  | 113/141 [00:14<00:03,  7.73it/s]
Evaluating...:  81%|████████  | 114/141 [00:15<00:03,  7.71it/s]
Evaluating...:  82%|████████▏ | 115/141 [00:15<00:03,  7.71it/s]
Evaluating...:  82%|████████▏ | 116/141 [00:15<00:03,  7.71it/s]
Evaluating...:  83%|████████▎ | 117/141 [00:15<00:03,  7.72it/s]
Evaluating...:  84%|████████▎ | 118/141 [00:15<00:02,  7.71it/s]
Evaluating...:  84%|████████▍ | 119/141 [00:15<00:02,  7.69it/s]
Evaluating...:  85%|████████▌ | 120/141 [00:15<00:02,  7.71it/s]
Evaluating...:  86%|████████▌ | 121/141 [00:15<00:02,  7.73it/s]
Evaluating...:  87%|████████▋ | 122/141 [00:16<00:02,  7.72it/s]
Evaluating...:  87%|████████▋ | 123/141 [00:16<00:02,  7.73it/s]
Evaluating...:  88%|████████▊ | 124/141 [00:16<00:02,  7.72it/s]
Evaluating...:  89%|████████▊ | 125/141 [00:16<00:02,  7.71it/s]
Evaluating...:  89%|████████▉ | 126/141 [00:16<00:01,  7.72it/s]
Evaluating...:  90%|█████████ | 127/141 [00:16<00:01,  7.74it/s]
Evaluating...:  91%|█████████ | 128/141 [00:16<00:01,  7.74it/s]
Evaluating...:  91%|█████████▏| 129/141 [00:16<00:01,  7.75it/s]
Evaluating...:  92%|█████████▏| 130/141 [00:17<00:01,  7.73it/s]
Evaluating...:  93%|█████████▎| 131/141 [00:17<00:01,  7.73it/s]
Evaluating...:  94%|█████████▎| 132/141 [00:17<00:01,  7.72it/s]
Evaluating...:  94%|█████████▍| 133/141 [00:17<00:01,  7.71it/s]
Evaluating...:  95%|█████████▌| 134/141 [00:17<00:00,  7.72it/s]
Evaluating...:  96%|█████████▌| 135/141 [00:17<00:00,  7.75it/s]
Evaluating...:  96%|█████████▋| 136/141 [00:17<00:00,  7.74it/s]
Evaluating...:  97%|█████████▋| 137/141 [00:18<00:00,  7.73it/s]
Evaluating...:  98%|█████████▊| 138/141 [00:18<00:00,  7.72it/s]
Evaluating...:  99%|█████████▊| 139/141 [00:18<00:00,  7.71it/s]
Evaluating...:  99%|█████████▉| 140/141 [00:18<00:00,  7.71it/s]
Evaluating...: 100%|██████████| 141/141 [00:18<00:00,  7.69it/s]
Evaluating...: 100%|██████████| 141/141 [00:18<00:00,  7.61it/s]
Perplexity: 6.36275577545166


bf16：
6.240086078643799
